# ğŸ¢ PipeOps CLI - ××“×¨×™×š ×”×ª×§× ×” ×œ×¡×‘×™×‘×” ××¨×’×•× ×™×ª

## ×¡×‘×™×‘×” ×œ×œ× ×’×™×©×” ×œ××™× ×˜×¨× ×˜ (Air-Gapped)

### ×“×¨×™×©×•×ª ××¢×¨×›×ª
- Python 3.8+
- ×’×™×©×” ×œ×©×¨×ª GitLab ×¤× ×™××™
- ×”×¨×©××•×ª ×œ×¤×¢×•×œ×•×ª Git ×•-API

### ×”×ª×§× ×” ×‘×¡×‘×™×‘×” ×¡×’×•×¨×”

#### ×©×œ×‘ 1: ×”×›× ×ª ×”×—×‘×™×œ×•×ª
```bash
# ×‘××—×©×‘ ×¢× ×’×™×©×” ×œ××™× ×˜×¨× ×˜ - ×”×›×Ÿ ××ª ×”×—×‘×™×œ×•×ª
pip download click PyYAML requests -d packages/

# ×”×¢×‘×¨ ××ª ×”×ª×™×§×™×™×” packages/ ×œ×¡×‘×™×‘×” ×”×¤× ×™××™×ª
```

#### ×©×œ×‘ 2: ×”×ª×§× ×” ×‘×¡×‘×™×‘×” ×”×¤× ×™××™×ª
```bash
# ×”×ª×§× ×” ××§×‘×¦×™× ××§×•××™×™×
pip install --no-index --find-links packages/ click PyYAML requests

# ×”×ª×§× ×ª ×”×›×œ×™
cd pipeops-cli
pip install -e .

# ×‘×“×™×§×”
pipeops-cli --version
```

### ×—×œ×•×¤×” ×¤×©×•×˜×” - ×œ×œ× pip
```bash
# ×”×•×¨×“ ××ª ×”×§×‘×¦×™× ×”× ×“×¨×©×™× ×™×©×™×¨×•×ª
# click, PyYAML, requests
# ×•×”×¢×ª×§ ××•×ª× ×œ×ª×™×§×™×™×ª Python site-packages

# ××œ×˜×¨× ×˜×™×‘×”: ×”×¨×¥ ×™×©×™×¨×•×ª
python cli.py --help
```

## ×”×’×“×¨×ª ×”×›×œ×™

### ××‘× ×” ×”×ª×™×§×™×•×ª
```
pipeops-cli/
â”œâ”€â”€ Config/
â”‚   â””â”€â”€ pipeline_definitions.yml  # ×§×•× ×¤×™×’×•×¨×¦×™×”
â”œâ”€â”€ Templates/                    # ×ª×‘× ×™×•×ª
â”‚   â”œâ”€â”€ Python-service/
â”‚   â”œâ”€â”€ Python-package/
â”‚   â””â”€â”€ Node-service/
â”œâ”€â”€ Core/                        # ×§×‘×¦×™ ×”×œ×™×‘×”
â”œâ”€â”€ Utiles/
â”‚   â””â”€â”€ logger.py
â””â”€â”€ cli.py                       # × ×§×•×“×ª ×›× ×™×¡×”
```

### ×”×’×“×¨×ª ×§×•×‘×¥ ×”×ª×¦×•×¨×”
×¢×¨×•×š ××ª `Config/pipeline_definitions.yml`:

```yaml
pipelines:
  python_service:
    template_path: Templates/Python-service
    description: "Python service with Docker deployment"
    required_env:
      - CI_REGISTRY_URL          # ×”×›×ª×•×‘×ª ×©×œ ×”×¨×™×©×•× ×”×¤× ×™××™
      - INTERNAL_TOKEN           # ×˜×•×§×Ÿ ×¤× ×™××™
    files_to_create:
      - .gitlab-ci.yml
      - oc_params/dev_values.yaml
      - oc_params/prod_values.yaml
    supported_languages:
      - python
    supported_types:
      - service

global:
  default_branches:
    source: "main"
    target: "develop"           # ×”×ª×× ×œ×¡×˜× ×“×¨×˜ ×”××¨×’×•× ×™
    feature_prefix: "feature/pipeline-setup"
```

### ×”×ª×××” ×œ×¡×‘×™×‘×” ×”××¨×’×•× ×™×ª

#### ×›×ª×•×‘×•×ª ×¤× ×™××™×•×ª
×”×—×œ×£ ×‘×ª×‘× ×™×•×ª:
- `registry.gitlab.com` â†’ `docker-registry.company.com`
- `https://gitlab.com` â†’ `https://gitlab.company.com`
- `pypi.org` â†’ `nexus.company.com/pypi`

#### ××™××•×ª ×•×˜×•×§× ×™×
```bash
# ×”×’×“×¨ ××©×ª× ×™ ×¡×‘×™×‘×”
export GITLAB_URL=https://gitlab.company.com
export GITLAB_TOKEN=your-internal-token
export DOCKER_REGISTRY=docker-registry.company.com
```

## ×©×™××•×© ×™×•××™

### ×¤×§×•×“×•×ª ×‘×¡×™×¡×™×•×ª
```bash
# ×‘×“×™×§×ª ×ª×§×™× ×•×ª
pipeops-cli validate

# ×¨×©×™××ª ×ª×‘× ×™×•×ª ×–××™× ×•×ª
pipeops-cli list

# ×™×¦×™×¨×ª pipeline ×—×“×©
pipeops-cli init \
  --project-url https://gitlab.company.com/team/project \
  --token $GITLAB_TOKEN

# ×‘×“×™×§×” ×™×‘×©×” ×œ×¤× ×™ ×¤×¢×•×œ×” ×××™×ª×™×ª
pipeops-cli init \
  --project-url https://gitlab.company.com/team/project \
  --token $GITLAB_TOKEN \
  --dry-run
```

### ××•×˜×•××¦×™×”
```bash
# ×¢×‘×•×¨ ×”×¨×‘×” ×¤×¨×•×™×§×˜×™×
cat projects.txt | while read project_url; do
  pipeops-cli init -p "$project_url" -t "$GITLAB_TOKEN" --auto-confirm
  sleep 5  # ×× ×•×—×” ×‘×™×Ÿ ×¤×¨×•×™×§×˜×™×
done
```

## ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª × ×¤×•×¦×•×ª

### ×‘×¢×™×•×ª ×”×ª×§× ×”
```bash
# ×× ×—×¡×¨×•×ª ×—×‘×™×œ×•×ª
python -c "import yaml, click, requests; print('OK')"

# ×× ×™×© ×‘×¢×™×•×ª ×¢× encoding
export PYTHONIOENCODING=utf-8
```

### ×‘×¢×™×•×ª ××™×©×•×¨×™ SSL
```bash
# ×œ×¡×‘×™×‘×•×ª ×¢× ×ª×¢×•×“×•×ª ×¤× ×™××™×•×ª
export PYTHONHTTPSVERIFY=0
# ××•
pip install --trusted-host gitlab.company.com
```

### ×‘×¢×™×•×ª ×”×¨×©××•×ª GitLab
×•×“× ×©×œ×˜×•×§×Ÿ ×™×© ×”×¨×©××•×ª:
- `api` - ×’×™×©×” ××œ××”
- `read_repository`
- `write_repository`

### ×‘×¢×™×•×ª ×‘×ª×‘× ×™×•×ª
```bash
# ×‘×“×•×§ ×©×”×ª×‘× ×™×•×ª ×§×™×™××•×ª
find Templates/ -name "*.yml" -o -name "*.yaml"

# ×‘×“×•×§ ××ª ×”××‘× ×”
pipeops-cli validate
```

## ×”×ª×××” ××™×©×™×ª

### ×”×•×¡×¤×ª ×ª×‘× ×™×ª ×—×“×©×”
1. ×¦×•×¨ ×ª×™×§×™×™×” ×—×“×©×” ×‘-`Templates/`
2. ×”×•×¡×£ ×§×‘×¦×™ ×ª×‘× ×™×ª ×¢× ××©×ª× ×™×: `{{project_name}}`, `{{creation_date}}`
3. ×¢×“×›×Ÿ ××ª `pipeline_definitions.yml`
4. ×‘×“×•×§: `pipeops-cli validate`

### ×”×ª×××ª ××©×ª× ×™×
××©×ª× ×™× ×–××™× ×™× ×‘×ª×‘× ×™×•×ª:
- `{{project_name}}` - ×©× ×”×¤×¨×•×™×§×˜
- `{{creation_date}}` - ×ª××¨×™×š ×™×¦×™×¨×”
- `{{creation_year}}` - ×©× ×ª ×™×¦×™×¨×”
- `{{language}}` - ×©×¤×ª ×ª×›× ×•×ª
- `{{pipeline_type}}` - ×¡×•×’ pipeline

### ×”×’×“×¨×•×ª ×‘×¨××ª ×”××¨×’×•×Ÿ
×¦×•×¨ ×§×•×‘×¥ ×ª×¦×•×¨×” ××¨×›×–×™:
```yaml
# /etc/pipeops/config.yml
global:
  company_registry: "docker-registry.company.com"
  company_gitlab: "https://gitlab.company.com"
  default_namespace: "devops"

  default_branches:
    source: "main"
    target: "develop"
    feature_prefix: "feature/ci-setup"
```

## ×‘×“×™×§×ª ××™×›×•×ª ×•×ª×—×–×•×§×”

### ×‘×“×™×§×•×ª ×ª×§×•×¤×ª×™×•×ª
```bash
# ×‘×“×•×§ ×©×”×›×œ ×¢×•×‘×“
pipeops-cli validate

# ×‘×“×•×§ ×’×™×©×” ×œ-GitLab
curl -H "PRIVATE-TOKEN: $GITLAB_TOKEN" \
  https://gitlab.company.com/api/v4/user

# ×‘×“×•×§ ×ª×‘× ×™×•×ª
for template in Templates/*/; do
  echo "Checking $template"
  find "$template" -name "*.yml" -exec yamllint {} \;
done
```

### ×¢×“×›×•×Ÿ ×”×ª×‘× ×™×•×ª
```bash
# ×’×‘×” ×ª×‘× ×™×•×ª ×§×™×™××•×ª
cp -r Templates Templates.backup.$(date +%Y%m%d)

# ×¢×“×›×Ÿ ×ª×‘× ×™×•×ª
# ×‘×“×•×§ ×©×™× ×•×™×™×
pipeops-cli validate

# ×‘×“×™×§×” ×™×‘×©×”
pipeops-cli init --dry-run -p test-project -t $token
```

## ××‘×˜×—×” ×•×”×¨×©××•×ª

### ×”×’×“×¨×•×ª ××‘×˜×—×”
- ×”×©×ª××© ×‘×˜×•×§× ×™× ×¢× ×”×¨×©××•×ª ××•×’×‘×œ×•×ª
- ×”×—×œ×£ ×˜×•×§× ×™× ×ª×§×•×¤×ª×™
- × ×˜×¨ ×¤×¢×™×œ×•×ª ×”×›×œ×™ ×‘×œ×•×’×™ GitLab

### × ×™×˜×•×¨ ×•×œ×•×’×™×
```bash
# ×”×¤×¢×œ ×¢× ×œ×•×’×™× ××¤×•×¨×˜×™×
pipeops-cli init -p project -t token --config debug.yml

# ×œ×•×’×™× ×œ×§×•×‘×¥
python -c "
from Utiles.logger import configure_logging
configure_logging('DEBUG', True, 'pipeops.log')
"
```

## ×ª××™×›×” ×¤× ×™××™×ª

### ××¡××›×™ ×¢×–×¨×”
- ×©××•×¨ ××ª ×”××“×¨×™×š ×”×–×” ×‘××™×§×•× × ×’×™×© ×œ×¦×•×•×ª
- ×¦×•×¨ ×“×•×’×××•×ª ×¡×¤×¦×™×¤×™×•×ª ×œ××¨×’×•×Ÿ
- ×ª×¢×“×•×§ ×ª×‘× ×™×•×ª ××•×ª×××•×ª ××™×©×™×ª

### ×”×“×¨×›×ª ×”×¦×•×•×ª
```bash
# ×”×›× ×ª ×¡×§×¨×™×¤×˜ ×”×“×’××”
#!/bin/bash
echo "PipeOps CLI Demo for DevOps Team"
echo "=================================="

echo "1. Validating configuration..."
pipeops-cli validate

echo "2. Listing available templates..."
pipeops-cli list

echo "3. Dry run example..."
pipeops-cli init --dry-run \
  -p https://gitlab.company.com/demo/project \
  -t demo-token

echo "Demo completed!"
```

×–×›×¨×•: ×”×›×œ×™ × ×•×¢×“ ×œ×”×™×•×ª ×¤×©×•×˜ ×•×™×¢×™×œ ×œ×¦×•×•×ª×™ DevOps. ×× ××©×”×• ×œ× ×‘×¨×•×¨ - ×ª××™×“ ××¤×©×¨ ×œ×‘×“×•×§ ××ª ×”×§×•×“ ×•×œ×”×ª××™×!